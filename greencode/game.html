<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ò–≥—Ä–∞ —Å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞–º–∏</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin-top: 50px;
            background-color: #f4f4f9;
            color: #333;
        }
        .input-group {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }
        .input-group label {
            font-weight: bold;
            margin-right: 5px;
        }
        .input-group input {
            width: 60px;
            padding: 5px;
            border: 1px solid #ccc;
            border-radius: 5px;
            text-align: center;
        }
        .game-board {
            display: grid;
            grid-template-columns: repeat(2, 100px);
            grid-gap: 10px;
            margin: 20px auto;
            justify-content: center;
        }
        .cell {
            width: 100px;
            height: 100px;
            background-color: #ccc;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 20px;
            border-radius: 10px;
            transition: background-color 0.3s;
        }
        .cell.revealed {
            background-color: #ddd;
            cursor: default;
        }
        .bonus-board {
            display: grid;
            grid-template-columns: repeat(2, 100px);
            grid-gap: 10px;
            margin: 20px auto;
            justify-content: center;
        }
        .bonus-board .cell {
            background-color: #ffcc00;
        }
        .message {
            margin-top: 20px;
            font-size: 18px;
            font-weight: bold;
        }
        .button {
            margin: 10px;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            border: none;
            border-radius: 5px;
            background-color: #007bff;
            color: white;
            transition: background-color 0.3s;
        }
        .button:hover {
            background-color: #0056b3;
        }
        .button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        #game-container {
            display: none;
        }
        #balance {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div id="balance">–ë–∞–ª–∞–Ω—Å: $1000.00</div>
    <div class="input-group">
        <div>
            <label for="k1">k1:</label>
            <input type="number" id="k1" value="1.03" step="0.01">
        </div>
        <div>
            <label for="k2">k2:</label>
            <input type="number" id="k2" value="1.22" step="0.01">
        </div>
        <div>
            <label for="k3">k3:</label>
            <input type="number" id="k3" value="2.63" step="0.01">
        </div>
        <div>
            <label for="b1">b1:</label>
            <input type="number" id="b1" value="1.2" step="0.1">
        </div>
        <div>
            <label for="b2">b2:</label>
            <input type="number" id="b2" value="1.3" step="0.1">
        </div>
        <div>
            <label for="b3">b3:</label>
            <input type="number" id="b3" value="1.5" step="0.1">
        </div>
        <div>
            <label for="b4">b4:</label>
            <input type="number" id="b4" value="2.0" step="0.1">
        </div>
    </div>
    <button id="start-game" class="button">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É (—Å—Ç–æ–∏–º–æ—Å—Ç—å: $1)</button>

    <div id="game-container">
        <div class="game-board" id="main-board"></div>
        <div class="bonus-board" id="bonus-board" style="display: none;"></div>
        <div class="message" id="message"></div>
        <button id="take-winnings" class="button">–ó–∞–±—Ä–∞—Ç—å —Ç–µ–∫—É—â–∏–π –≤—ã–∏–≥—Ä—ã—à</button>
    </div>

    <script>
        let k1, k2, k3, b1, b2, b3, b4;
        let mainBoard, bonusBoard;
        let mineIndex, bonusIndex;
        let revealedCells = 0;
        let totalWinnings = 0;
        let bonusMultiplier = 1;
        let gameActive = false;
        let balance = 1000;
        let bonusRevealed = false; // –§–ª–∞–≥ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è, –±—ã–ª–∞ –ª–∏ –æ—Ç–∫—Ä—ã—Ç–∞ –∫–ª–µ—Ç–∫–∞ –≤ –±–æ–Ω—É—Å–Ω–æ–º –ø–æ–ª–µ
        let winningsAdded = false; // –§–ª–∞–≥ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è, –±—ã–ª –ª–∏ –≤—ã–∏–≥—Ä—ã—à —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω

        document.getElementById('start-game').addEventListener('click', startGame);
        document.getElementById('take-winnings').addEventListener('click', takeWinnings);

        function updateBalance() {
            document.getElementById('balance').innerText = `–ë–∞–ª–∞–Ω—Å: $${balance.toFixed(2)}`;
        }

        function startGame() {
            if (balance < 1) {
                alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –¥–ª—è –Ω–∞—á–∞–ª–∞ –∏–≥—Ä—ã!");
                return;
            }

            // –ï—Å–ª–∏ –∏–≥—Ä–∞ —É–∂–µ –±—ã–ª–∞ –Ω–∞—á–∞—Ç–∞, –¥–æ–±–∞–≤–ª—è–µ–º –≤—ã–∏–≥—Ä—ã—à –∫ –±–∞–ª–∞–Ω—Å—É
            if (gameActive && !winningsAdded) {
                balance += totalWinnings * bonusMultiplier;
                winningsAdded = true;
                updateBalance();
            }

            balance -= 1;
            updateBalance();

            k1 = parseFloat(document.getElementById('k1').value);
            k2 = parseFloat(document.getElementById('k2').value);
            k3 = parseFloat(document.getElementById('k3').value);
            b1 = parseFloat(document.getElementById('b1').value);
            b2 = parseFloat(document.getElementById('b2').value);
            b3 = parseFloat(document.getElementById('b3').value);
            b4 = parseFloat(document.getElementById('b4').value);

            document.getElementById('game-container').style.display = 'block';
            document.getElementById('start-game').disabled = true;
            resetGame();
        }

        function resetGame() {
            mainBoard = document.getElementById('main-board');
            bonusBoard = document.getElementById('bonus-board');
            mainBoard.innerHTML = '';
            bonusBoard.innerHTML = '';
            revealedCells = 0;
            totalWinnings = 0;
            bonusMultiplier = 1;
            gameActive = true;
            bonusRevealed = false;
            winningsAdded = false;

            mineIndex = Math.floor(Math.random() * 4);
            bonusIndex = Math.floor(Math.random() * 4);
            while (bonusIndex === mineIndex) {
                bonusIndex = Math.floor(Math.random() * 4);
            }

            for (let i = 0; i < 4; i++) {
                const cell = document.createElement('div');
                cell.classList.add('cell');
                cell.dataset.index = i;
                cell.addEventListener('click', () => revealCell(i));
                mainBoard.appendChild(cell);
            }

            document.getElementById('message').innerText = '–ò–≥—Ä–∞ –Ω–∞—á–∞–ª–∞—Å—å!';
        }

        function revealCell(index) {
            if (!gameActive) return;

            const cell = mainBoard.children[index];
            if (cell.classList.contains('revealed')) return;

            cell.classList.add('revealed');
            revealedCells++;

            if (index === mineIndex) {
                cell.innerText = 'üí£';
                endGame(false);
            } else if (index === bonusIndex) {
                cell.innerText = 'üéÅ';
                showBonusBoard();
            } else {
                cell.innerText = '‚úÖ';
                updateWinnings();
            }

            // –ï—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç–æ 3 –∫–ª–µ—Ç–∫–∏ –∏ –º–∏–Ω–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞, –∑–∞–≤–µ—Ä—à–∞–µ–º –∏–≥—Ä—É
            if (revealedCells === 3 && index !== mineIndex) {
                if (index === bonusIndex) {
                    // –ï—Å–ª–∏ –±–æ–Ω—É—Å –æ—Ç–∫—Ä—ã—Ç —Ç—Ä–µ—Ç—å–∏–º, –∂–¥–µ–º –≤—ã–±–æ—Ä–∞ –±–æ–Ω—É—Å–Ω–æ–≥–æ –ø–æ–ª—è
                    return;
                }
                endGame(true);
            }
        }

        function updateWinnings() {
            if (revealedCells === 1) totalWinnings = k1;
            else if (revealedCells === 2) totalWinnings = k2;
            else if (revealedCells === 3) totalWinnings = k3;

            document.getElementById('message').innerText = `–í—ã–∏–≥—Ä—ã—à: $${(totalWinnings * bonusMultiplier).toFixed(2)}`;
        }

        function showBonusBoard() {
            bonusBoard.style.display = 'grid';
            for (let i = 0; i < 4; i++) {
                const cell = document.createElement('div');
                cell.classList.add('cell');
                cell.dataset.index = i;
                cell.addEventListener('click', () => revealBonusCell(i));
                bonusBoard.appendChild(cell);
            }
        }

        function revealBonusCell(index) {
            if (bonusRevealed) return; // –ï—Å–ª–∏ —É–∂–µ –æ—Ç–∫—Ä—ã—Ç–∞ –∫–ª–µ—Ç–∫–∞ –≤ –±–æ–Ω—É—Å–Ω–æ–º –ø–æ–ª–µ, –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ–º

            const cell = bonusBoard.children[index];
            cell.classList.add('revealed');
            const bValues = [b1, b2, b3, b4];
            const randomB = bValues[Math.floor(Math.random() * bValues.length)];
            cell.innerText = randomB;
            bonusMultiplier *= randomB;
            updateWinnings();
            bonusRevealed = true; // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥, —á—Ç–æ –∫–ª–µ—Ç–∫–∞ –≤ –±–æ–Ω—É—Å–Ω–æ–º –ø–æ–ª–µ –æ—Ç–∫—Ä—ã—Ç–∞

            // –ï—Å–ª–∏ –±–æ–Ω—É—Å–Ω–∞—è –∫–ª–µ—Ç–∫–∞ –±—ã–ª–∞ –æ—Ç–∫—Ä—ã—Ç–∞ —Ç—Ä–µ—Ç—å–µ–π, –∑–∞–≤–µ—Ä—à–∞–µ–º –∏–≥—Ä—É –∏ –¥–æ–±–∞–≤–ª—è–µ–º –≤—ã–∏–≥—Ä—ã—à
            if (revealedCells === 3) {
                endGame(true);
            }
        }

        function endGame(won) {
            if (!gameActive || winningsAdded) return; // –ï—Å–ª–∏ –∏–≥—Ä–∞ —É–∂–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ –∏–ª–∏ –≤—ã–∏–≥—Ä—ã—à —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω, –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ–º

            gameActive = false;
            winningsAdded = true; // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥, —á—Ç–æ –≤—ã–∏–≥—Ä—ã—à –¥–æ–±–∞–≤–ª–µ–Ω

            if (won) {
                balance += totalWinnings * bonusMultiplier;
                updateBalance();
                document.getElementById('message').innerText = `–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í–∞—à –≤—ã–∏–≥—Ä—ã—à: $${(totalWinnings * bonusMultiplier).toFixed(2)}`;
            } else {
                document.getElementById('message').innerText = '–í—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏!';
            }
            document.getElementById('start-game').disabled = false;
        }

        function takeWinnings() {
            if (gameActive) {
                endGame(true); // –ó–∞–≤–µ—Ä—à–∞–µ–º –∏–≥—Ä—É —Å –≤—ã–∏–≥—Ä—ã—à–µ–º
            }
        }

        updateBalance();
    </script>
</body>
</html>